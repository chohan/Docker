FROM ubuntu:latest
MAINTAINER Salah Chohan
LABEL version="1.0" Location="Canada/Toronto" type="ubuntu_dev"

# ensure bashrc is present
COPY .bashrc /root/.bashrc
COPY .vimrc /root/.vimrc

RUN apt update -y
RUN apt install -y apt-utils openssh* vim tree tmux
RUN apt install -y build-essential cmake pkg-config ca-certificates
RUN apt install -y autotools-dev
RUN apt install -y g++ 
RUN apt install -y gdb
RUN apt install -y git
#RUN apt install -y libboost-all-dev
RUN apt install -y libicu-dev
RUN apt install -y libusb-dev
#RUN apt install -y libbz2-dev
RUN apt install -y libzmq3-dev      

# install boost
RUN wget http://downloads.sourceforge.net/project/boost/boost/1.70.0/boost_1_70_0.tar.gz
RUN tar -zxvf boost_1_70_0.tar.gz
RUN cd boost_1_70_0 && ./bootstrap.sh && ./b2 && cd -
RUN rm -f boost_1_70_0.tar.gz

# install python
#RUN apt install -y python-dev
RUN apt install -y python python-pip python3-pip
RUN python -m pip install --user numpy pandas
RUN python3 -m pip install --user numpy pandas
RUN python3 -m pip install --user websockets

# install net tools
RUN apt install -y arp-scan ipcalc htop nmap netcat net-tools curl iftop iptables ngrep socat tcpdump telnet traceroute wget
# unable to locate ncat dhclient iputilsy ping route websocat wireshark

# install Golang
RUN mkdir -p /goroot && curl https://storage.googleapis.com/golang/go1.4.2.linux-amd64.tar.gz | tar xvzf - -C /goroot --strip-components=1
ENV GOROOT /goroot
ENV PATH $GOROOT/bin:$PATH

# clean up
RUN apt clean && rm -rf /var/lib/apt/lists/*

# SSH server setup
RUN sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config
RUN echo 'root:toor' | chpasswd
RUN echo "service ssh restart" >> /start.sh
RUN echo "/bin/bash" >> /start.sh
RUN chmod +x /start.sh
EXPOSE 22
WORKDIR /root
USER root
ENTRYPOINT /start.sh


## commands to build and run
#/bin/systemctl restart ssh.service
# docker build -f ubuntu_dev.df -t ubuntu_dev .
# docker run --rm -it -v /D_DRIVE:/d -v /E_DRIVE:/e -p 2222:22 --name ubuntu_dev ubuntu_dev
# docker run --rm -it -v /C:/c -v /D:/d -p 2222:22 --name ubuntu_dev shchohan/ubuntu_dev
# docker run --rm -it -v /C:/c -v /D:/d -p 2222:22 --privileged -v /dev/bus/usb:/dev/bus/usb --cap-add=SYS_PTRACE --security-opt seccomp=unconfined --name ubuntu_dev shchohan/ubuntu_dev:latest
# ssh root@192.168.99.100 -p 2222

